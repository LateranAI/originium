#

## 文件说明

- `genome_clusters.jsonl.gz`: 每一行为一个物种所含有的DNA序列ID列表。
- `output.ani_matrix.tsv.gz`: 不同序列间的ANI的矩阵，`Query_name`和`Ref_name`分别为序列ID，`ANI`为它们之间的ANI值。

    | Query_name | Ref_name | Align_fraction_query | Align_fraction_ref | ANI |
    |------------|----------|---------------------|-------------------|-----|
    | NZ_CP162551.1 | NC_013791.2 | 15.3 | 14.27 | 81.05 |
    | NZ_JARSOQ010000001.1 | NC_013791.2 | 86.19 | 83.49 | 96.6 |
    | NZ_BMPP01000001.1 | NC_012526.1 | 42.16 | 47.31 | 85.29 |

    现有工具计算出的ANI值可信范围在82-100%之间，小于82%的按82%处理。如果要用cossim拟合的话估计需要想办法映射到[-1, 1]。另外注意采样，ANI值并不是均匀分布的。
- `paired.fasta.gz`: 在`output.ani_matrix.tsv.gz`中有记录的序列ID对应的FASTA文件，包含了所有的序列。
- `rescued.fasta.gz`: 虽然没有在`output.ani_matrix.tsv.gz`中有记录，但都是从高质量的细菌基因组中提取的序列，所以可能可以拿来做一些采样来补充>95% ANI的数据。

## ANI目标

其实并不需要准确地预测ANI的值，但是要能够预测出几个范围的ANI值，比如：

- < 85% ANI: 不同属的不同物种
- 85% - 95% ANI: 同属的不同物种
- \> 95% ANI: 同种的不同菌株

尤其是 > 95% ANI的菌株，对于宏基因组学的分析非常重要，因为宏组学是从环境样本中提取的DNA进行的测序，往往会有几百个物种的DNA混合在一起，这会导致组装过程变得极其困难，下游的分析（比如从组装结果中还原每个物种的基因组）也会受到影响。如果能够直接按照95% ANI对序列进行聚类，那么就可以提取出很有可能来自于同一物种的序列，以及支持这些序列的测序数据，然后再进行基因组的组装和分析，就能够大大提高组装的质量和准确性。
